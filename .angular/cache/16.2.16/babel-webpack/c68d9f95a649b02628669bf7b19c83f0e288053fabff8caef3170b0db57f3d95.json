{"ast":null,"code":"import { map } from 'rxjs';\nimport { environment } from '../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nexport class ProductService {\n  constructor(http) {\n    this.http = http;\n    this.selectedProduct = localStorage.getItem('selectedProduct') || '';\n    this.lastAnswers = ProductService.safeParse(localStorage.getItem('lastAnswers'));\n    this.lastProducts = ProductService.safeParse(localStorage.getItem('lastProducts')) || [];\n  }\n  setSelectedProduct(product) {\n    this.selectedProduct = product || '';\n    localStorage.setItem('selectedProduct', this.selectedProduct);\n  }\n  getSelectedProduct() {\n    if (!this.selectedProduct) {\n      this.selectedProduct = localStorage.getItem('selectedProduct') || '';\n    }\n    return this.selectedProduct;\n  }\n  setAnswers(a) {\n    this.lastAnswers = a ?? null;\n    if (this.lastAnswers !== null) {\n      localStorage.setItem('lastAnswers', JSON.stringify(this.lastAnswers));\n    } else {\n      localStorage.removeItem('lastAnswers');\n    }\n  }\n  getAnswers() {\n    if (this.lastAnswers == null) {\n      this.lastAnswers = ProductService.safeParse(localStorage.getItem('lastAnswers'));\n    }\n    return this.lastAnswers;\n  }\n  setProducts(list) {\n    this.lastProducts = Array.isArray(list) ? list : [];\n    localStorage.setItem('lastProducts', JSON.stringify(this.lastProducts));\n  }\n  getProducts() {\n    if (!this.lastProducts?.length) {\n      this.lastProducts = ProductService.safeParse(localStorage.getItem('lastProducts')) || [];\n    }\n    return this.lastProducts;\n  }\n  getMlProducts(payload) {\n    const url = `${environment.apiUrl}/ml-products`;\n    return this.http.post(url, payload).pipe(map(arr => Array.isArray(arr) ? arr : []));\n  }\n  static safeParse(raw) {\n    if (!raw) return null;\n    try {\n      return JSON.parse(raw);\n    } catch {\n      return null;\n    }\n  }\n  static {\n    this.ɵfac = function ProductService_Factory(t) {\n      return new (t || ProductService)(i0.ɵɵinject(i1.HttpClient));\n    };\n  }\n  static {\n    this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n      token: ProductService,\n      factory: ProductService.ɵfac,\n      providedIn: 'root'\n    });\n  }\n}","map":{"version":3,"names":["map","environment","ProductService","constructor","http","selectedProduct","localStorage","getItem","lastAnswers","safeParse","lastProducts","setSelectedProduct","product","setItem","getSelectedProduct","setAnswers","a","JSON","stringify","removeItem","getAnswers","setProducts","list","Array","isArray","getProducts","length","getMlProducts","payload","url","apiUrl","post","pipe","arr","raw","parse","i0","ɵɵinject","i1","HttpClient","factory","ɵfac","providedIn"],"sources":["C:\\Users\\zehav\\Desktop\\matchmybeauty\\client\\src\\app\\services\\product.service.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\r\nimport { HttpClient } from '@angular/common/http';\r\nimport { Observable, map } from 'rxjs';\r\nimport { environment } from '../../environments/environment';\r\n\r\n@Injectable({ providedIn: 'root' })\r\nexport class ProductService {\r\n  private selectedProduct: string = localStorage.getItem('selectedProduct') || '';\r\n  private lastAnswers: any | null = ProductService.safeParse(localStorage.getItem('lastAnswers'));\r\n  private lastProducts: any[] = ProductService.safeParse(localStorage.getItem('lastProducts')) || [];\r\n\r\n  constructor(private http: HttpClient) {}\r\n\r\n  setSelectedProduct(product: string): void {\r\n    this.selectedProduct = product || '';\r\n    localStorage.setItem('selectedProduct', this.selectedProduct);\r\n  }\r\n\r\n  getSelectedProduct(): string {\r\n    \r\n    if (!this.selectedProduct) {\r\n      this.selectedProduct = localStorage.getItem('selectedProduct') || '';\r\n    }\r\n    return this.selectedProduct;\r\n  }\r\n\r\n  setAnswers(a: any): void {\r\n    this.lastAnswers = a ?? null;\r\n    if (this.lastAnswers !== null) {\r\n      localStorage.setItem('lastAnswers', JSON.stringify(this.lastAnswers));\r\n    } else {\r\n      localStorage.removeItem('lastAnswers');\r\n    }\r\n  }\r\n\r\n  getAnswers(): any | null {\r\n    if (this.lastAnswers == null) {\r\n      this.lastAnswers = ProductService.safeParse(localStorage.getItem('lastAnswers'));\r\n    }\r\n    return this.lastAnswers;\r\n  }\r\n\r\n  setProducts(list: any[] | null | undefined): void {\r\n    this.lastProducts = Array.isArray(list) ? list : [];\r\n    localStorage.setItem('lastProducts', JSON.stringify(this.lastProducts));\r\n  }\r\n\r\n  getProducts(): any[] {\r\n    if (!this.lastProducts?.length) {\r\n      this.lastProducts = ProductService.safeParse(localStorage.getItem('lastProducts')) || [];\r\n    }\r\n    return this.lastProducts;\r\n  }\r\n\r\n  getMlProducts(payload: any): Observable<any[]> {\r\n    const url = `${environment.apiUrl}/ml-products`;\r\n    return this.http.post<any[]>(url, payload).pipe(\r\n      map((arr) => (Array.isArray(arr) ? arr : []))\r\n    );\r\n  }\r\n\r\n  private static safeParse(raw: string | null): any | null {\r\n    if (!raw) return null;\r\n    try {\r\n      return JSON.parse(raw);\r\n    } catch {\r\n      return null;\r\n    }\r\n  }\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}